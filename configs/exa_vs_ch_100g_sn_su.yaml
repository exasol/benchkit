title: "Exasol vs ClickHouse Performance Comparison on TPC-H SF100"
author: "Oleksandr Kozachuk, Principal Architect at Exasol AG"

# Execution configuration (optional)
execution:
  parallel: true          # Enable parallel execution of systems (default: false)
  max_workers: 2          # Max concurrent systems (default: number of systems)

env:
  mode: "aws"                    # aws, gcp, azure, or local
  region: "eu-west-1"
  allow_external_database_access: true  # Allow external access to database ports
  # Instance configuration per system
  instances:
    exasol:
      instance_type: "r6id.8xlarge"  # 32 vCPUs, 256GB RAM, 1.9TB NVMe local storage
      disk:
        type: "local"              # Use local NVMe for best performance
      label: "ok-bench-exa-sn-su"
    clickhouse:
      instance_type: "r6id.8xlarge"  # 32 vCPUs, 256GB RAM, 1.9TB NVMe local storage
      disk:
        type: "local"              # Use local NVMe for best performance
      label: "ok-bench-ch-sn-su"
  os_image: "ubuntu-22.04"
  ssh_key_name: "ok-work3"            # AWS key pair name (without .pem extension)
  ssh_private_key_path: "~/.ssh/ok-work3.pem"  # Local private key file path

systems:
  - name: "exasol"
    kind: "exasol"
    version: "2025.1.0"          # Latest Exasol version
    setup:
      method: "installer"        # Native c4 installation
      use_additional_disk: true  # Auto-detect and use additional NVMe disk
      c4_version: "4.28.2"       # Latest c4 version
      host_addrs: "$EXASOL_PRIVATE_IP"  # Will be resolved from infrastructure
      host_external_addrs: "$EXASOL_PUBLIC_IP"
      image_password: "exasol123"
      db_password: "exasol456"
      admin_password: "exasol789"
      working_copy: "@exasol-2025.1.0"
      license_file: "configs/exasol.license"  # License file path
      extra:
        dbram: "220g"            # Database RAM allocation (increased for SF100 on 256GB instance)
        optimizer_mode: "analytical"
        # Exasol database parameters for analytical workload optimization
        db_params:
          - "-writeTouchInit=1"
          - "-cacheMonitorLimit=0"
          - "-maxOverallSlbUsageRatio=0.95"
          - "-useQueryCache=0"
          - "-query_log_timeout=0"
          - "-joinOrderMethod=0"
          - "-etlCheckCertsDefault=0"

  - name: "clickhouse"
    kind: "clickhouse"
    version: "25.10.2.65"            # Latest stable ClickHouse version
    setup:
      method: "native"           # Native APT installation
      use_additional_disk: true  # Auto-detect and use additional NVMe disk
      data_dir: "/data/clickhouse"
      host: "$CLICKHOUSE_PUBLIC_IP"  # Use public IP for external access
      port: 8123                 # HTTP port for clickhouse-connect
      username: "default"
      password: "clickhouse123"  # Password for benchmark user
      extra:
        memory_limit: "230g"     # Memory limit for ClickHouse (~90% of 256GB)
        max_threads: "32"        # Match instance vCPUs
        max_memory_usage: "200000000000"  # ~200GB per query for large joins
        max_bytes_before_external_group_by: "100000000000"  # 100GB - use disk for large GROUP BY
        max_bytes_before_external_sort: "100000000000"      # 100GB - use disk for large sorts

workload:
  name: "tpch"
  scale_factor: 100             # 100GB dataset
  runs_per_query: 7             # Number of measured runs
  warmup_runs: 1                # Warmup runs before measurement
  data_format: "csv"            # csv or parquet
  generator: "dbgen"

report:
  show_boxplots: true
  show_latency_cdf: true
  show_bar_chart: true
  show_heatmap: true
